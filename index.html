<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>BET300 ¬∑ Raspad√≥n</title>
<meta name="theme-color" content="#0b0f1e"/>
<style>
:root{
  --bg:#0b0f1e; --panel:#121634; --panel2:#0f1330; --border:#1e2150;
  --text:#e8ebff; --muted:#b7b9d6; --ok:#25D366; --accent:#ff914d; --accent2:#ffd166;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);
  font:16px/1.35 system-ui,-apple-system,Segoe UI,Roboto}
body::before{
  content:"";position:fixed;inset:0;z-index:-2;
  background:
    radial-gradient(900px 500px at 50% -10%, rgba(101,74,255,.25), transparent),
    radial-gradient(700px 350px at 100% 0%, rgba(0,209,255,.18), transparent),
    linear-gradient(180deg,#0b0f1e 0%,#0b0f1e 60%,#0a0d20 100%);
}

/* Layout */
.container{max-width:980px;margin:14px auto;padding:0 14px 92px}
@media(max-width:520px){.container{padding:0 0 92px}}
.card{background: radial-gradient(120% 100% at 50% 0%, rgba(124,77,255,.08), transparent), var(--panel2);
  border:1px solid var(--border);border-radius:18px;padding:18px;box-shadow:0 15px 40px rgba(0,0,0,.35)}
@media(max-width:520px){.card{border-radius:0;border-left:0;border-right:0;padding:14px}}

.head{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:8px}
.brand{height:34px;padding:6px 14px;border-radius:12px;
  background:linear-gradient(90deg,#ffb56b,#ff8b2d);color:#0a1020;font-weight:900;display:inline-flex;align-items:center}
.pill{background:linear-gradient(90deg,rgba(124,77,255,.15),rgba(0,209,255,.15));
  border:1px solid var(--border);border-radius:999px;padding:6px 10px;font-size:12px;color:var(--muted)}
.pill.time{display:flex;gap:8px;align-items:center}
.pill.sound{cursor:pointer;user-select:none}
.count{display:inline-flex;gap:6px;align-items:center;padding:4px 8px;border-radius:999px;background:rgba(255,204,0,.15);
  border:1px solid rgba(255,204,0,.35);color:#ffe27a;font-weight:700;font-variant-numeric:tabular-nums}

.grid{display:grid;gap:16px;grid-template-columns:minmax(0,1fr)}
@media(min-width:900px){.grid{grid-template-columns:1.1fr .9fr}}

.panel{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px}
.center{text-align:center}
h1,h2,h3,p{margin:0 0 8px}
h1{font-size:24px}
.muted{color:var(--muted)}

/* Raspad√≥n ‚Äî carrusel vertical */
.reelStage{display:flex;justify-content:center}
.reelWrap{width:min(520px,92%);margin:auto;background:linear-gradient(180deg,#0e1436,#0a0f2a);
  border:1px solid var(--border);border-radius:18px;padding:16px;position:relative}
.reelTitle{font-weight:900;font-size:24px;text-align:center;margin-bottom:6px}
.reelSub{color:var(--muted);text-align:center;margin-bottom:12px}

/* Ventana/visor */
.viewport{position:relative;margin:0 auto;border-radius:16px;
  width:100%;max-width:520px;height:120px;overflow:hidden;
  border:1px solid rgba(255,255,255,.08);
  background:linear-gradient(180deg,#0b1030 0%,#121744 100%);box-shadow:inset 0 0 18px rgba(0,0,0,.45)}
/* Sensaci√≥n de borde luminoso */
.viewport::before{content:"";position:absolute;inset:-2px;border-radius:18px;
  padding:2px;--g:linear-gradient(90deg,#7c4dff,#00d1ff);
  background:var(--g);-webkit-mask:linear-gradient(#000 0 0) content-box,linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;mask-composite:exclude;opacity:.45}

/* Carril de items */
.reel{position:absolute;left:0;right:0;top:0;will-change:transform}
.item{display:flex;align-items:center;justify-content:center;
  height:120px;margin:0 8px;font-weight:900;
  color:#0b0f1e;border-radius:14px;box-shadow:0 8px 18px rgba(0,0,0,.35);
  background:linear-gradient(135deg,#ffd166,#ff8fab);border:1px solid rgba(255,255,255,.35);
  text-shadow:0 1px 0 rgba(255,255,255,.5)}
.item span{font-size:38px}

/* Panel derecho */
.badge{min-width:84px;height:52px;border-radius:12px;background:radial-gradient(100% 100% at 50% 0%, rgba(0,209,255,.35), rgba(124,77,255,.35));
  display:grid;place-items:center;font-weight:800;font-size:20px;box-shadow:inset 0 0 10px rgba(124,77,255,.35)}
.stat{display:flex;gap:12px;align-items:center;justify-content:center;margin:8px 0 14px}
.btn{appearance:none;border:none;cursor:pointer;padding:14px 16px;border-radius:14px;font-weight:800;
  color:#0a1020;width:100%;box-shadow:0 8px 20px rgba(0,0,0,.35)}
.btn:disabled{opacity:.55;cursor:not-allowed}
.btn.spin{background:linear-gradient(90deg,var(--accent),#ff6f00)}
.btn.ok{background:var(--ok);color:#0b0f1e}
.btn.play{background:linear-gradient(90deg,#ffd166,#ff7ab6);color:#0a1020}

.promo{display:grid;grid-template-columns:1fr minmax(200px,260px);align-items:center;gap:12px;margin-top:12px;padding:12px;border:1px dashed var(--border);border-radius:12px}
.promo.expired{border-color:rgba(255,107,107,.5)}
@media(max-width:520px){.promo{grid-template-columns:1fr}}
.eyebrow{padding:2px 8px;border-radius:999px;border:1px solid rgba(255,204,0,.35);background:rgba(255,204,0,.12);color:#ffe27a;font-weight:700;font-size:12px;width:max-content}

/* Dock (fijo abajo en m√≥vil) */
.dock{position:fixed;left:0;right:0;bottom:0;z-index:20;
  background:linear-gradient(180deg, rgba(11,15,30,0) 0%, rgba(11,15,30,.85) 22%, rgba(11,15,30,.95) 100%);
  padding:10px 16px 14px;display:flex;gap:12px;align-items:center}
@media(min-width:900px){.dock{position:static;background:none;padding:0;gap:12px}}
.dock .btn{flex:1}

/* Modal premio */
.backdrop{position:fixed;inset:0;background:rgba(0,0,0,.65);backdrop-filter:blur(2px);display:none;align-items:center;justify-content:center;z-index:50}
.backdrop.show{display:flex}
.modal{width:min(520px,92%);border-radius:18px;padding:18px;border:1px solid var(--border);
  background:linear-gradient(180deg,#0e1436,#10163b)}
.modal h2{margin:0 0 8px;font-size:26px}
.winTag{display:inline-block;background:linear-gradient(90deg,#7c4dff,#00d1ff);
  padding:8px 12px;border-radius:12px;font-weight:900;margin:8px 0}

/* Confeti */
#confetti{position:fixed;pointer-events:none;inset:0;z-index:55}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <div class="head">
      <div class="brand">BET300</div>
      <span class="pill">Promo interactiva</span>
      <span class="pill time">‚ö° Tiempo limitado <span class="count" id="countdown">--:--</span></span>
      <span class="pill sound" id="soundToggle">üîä Sonido: <b id="soundState">ON</b></span>
    </div>

    <div class="grid">
      <!-- Izquierda: Raspad√≥n -->
      <div class="panel">
        <div class="reelStage">
          <div class="reelWrap">
            <div class="reelTitle">Raspad√≥n vertical</div>
            <div class="reelSub">Desliz√° y gan√°: ¬°ten√©s 1 oportunidad por d√≠a!</div>

            <div class="viewport" id="viewport">
              <div class="reel" id="reel"><!-- items inyectados por JS --></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Derecha: Premio/CTA -->
      <div class="panel">
        <div class="center">
          <div class="stat">
            <div class="badge" id="badge">-</div>
            <div>
              <h1 id="title">Ten√©s 1 intento disponible</h1>
              <p class="muted" id="subtitle">Los premios se acreditan con tu <b>pr√≥xima carga m√≠nima</b>.</p>
            </div>
          </div>
        </div>

        <div class="dock" id="dock">
          <button id="spinBtn" class="btn spin">üéØ Girar</button>
          <button id="claimBtn" class="btn ok" disabled>üì≤ Reclamar</button>
        </div>

        <div class="promo" id="promoBox">
          <div class="copy">
            <span class="eyebrow">Acceso especial</span>
            <strong>Entr√° a la plataforma y particip√° antes de que termine.</strong>
            <span class="muted">V√°lida solo hoy.</span>
          </div>
          <a id="playNow" class="btn play" target="_blank" rel="noopener">üéÆ Entrar a la plataforma</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal premio -->
<div class="backdrop" id="backdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="winTitle">
    <h2 id="winTitle">üéâ ¬°Premio obtenido!</h2>
    <div class="winTag" id="winTag">$0</div>
    <p class="muted" id="winText">Se acredita con tu pr√≥xima carga.</p>
    <div style="display:flex;gap:10px;margin-top:12px">
      <button id="modalClaim" class="btn ok">üì≤ Reclamar por WhatsApp</button>
      <button id="modalClose" class="btn">Cerrar</button>
    </div>
  </div>
</div>
<canvas id="confetti"></canvas>

<script>
/* =================== Config b√°sica =================== */
const VALUES = [2000,3000,4000,5000,6000,7000,8000,9000,10000]; // puedes cambiar
// Para que sean 6 opciones visibles, duplicamos/mezclamos:
const PRIZES = [2000,3000,4000,5000,7000,10000]; // ‚Äúsurtido‚Äù

/* WhatsApp y plataforma por PC */
const WP_NUMBERS = { principal:"5491157737173", pc1:"5491138601132", pc2:"5491138214312", pc3:"5491168392647" };
const PLATFORM_LINKS = { principal:"https://plataforma.example/inicio", pc1:"https://c01.bet300vip.com/", pc2:"https://c02.bet300vip.com/", pc3:"https://c03.bet300vip.com/" };

const params = new URLSearchParams(location.search);
const pc = params.get('pc');
let WP = WP_NUMBERS.principal, PLATFORM = PLATFORM_LINKS.principal;
if(pc==='1'){ WP=WP_NUMBERS.pc1; PLATFORM=PLATFORM_LINKS.pc1; }
if(pc==='2'){ WP=WP_NUMBERS.pc2; PLATFORM=PLATFORM_LINKS.pc2; }
if(pc==='3'){ WP=WP_NUMBERS.pc3; PLATFORM=PLATFORM_LINKS.pc3; }
document.getElementById('playNow').href = PLATFORM;

/* =================== Audio (WebAudio) =================== */
let soundOn = true;
const soundState = document.getElementById('soundState');
document.getElementById('soundToggle').addEventListener('click',()=>{
  soundOn=!soundOn; soundState.textContent = soundOn ? 'ON' : 'OFF';
});
const AudioKit=(()=>{
  const Ctx=window.AudioContext||window.webkitAudioContext; const ctx=new Ctx(); let unlocked=false;
  function unlock(){ if(!unlocked){ ctx.resume().catch(()=>{}); unlocked=true; } }
  function click(freq=900,dur=0.04,vol=0.05){
    const o=ctx.createOscillator(), g=ctx.createGain(); o.type='square'; o.frequency.value=freq;
    g.gain.value=0; o.connect(g).connect(ctx.destination); const t=ctx.currentTime;
    g.gain.linearRampToValueAtTime(vol,t+0.005); g.gain.exponentialRampToValueAtTime(0.0001,t+dur);
    o.start(t); o.stop(t+dur);
  }
  function spinTicks(){ const id=setInterval(()=>click(700+Math.random()*300,0.03,0.045),95); return ()=>clearInterval(id); }
  function win(){ [880,1175,1568].forEach((f,i)=>setTimeout(()=>click(f,0.12,0.09), i*130)); }
  return {unlock,spinTicks,win};
})();
document.addEventListener('click',()=>AudioKit.unlock(),{once:true});

/* =================== Utilidades =================== */
const money = n => "$"+n.toLocaleString("es-AR");
const whatsappText = v => `Hola, gan√© ${money(v)} en el Raspad√≥n de BET300 y quiero reclamarlo con mi pr√≥xima carga.`;

/* =================== Reel =================== */
const viewport = document.getElementById('viewport');
const reel = document.getElementById('reel');
let itemH = 120; // coincide con CSS .item height
let spinning=false, stopTicks=null, angle=0;

/* Inyectar items (repetidos arriba/abajo para looping visual) */
function buildReel(){
  reel.innerHTML="";
  const items = [...PRIZES];
  // duplico al inicio y final para que el scroll sea continuo
  const pre  = items.slice(-3);
  const post = items.slice(0,3);
  const full = [...pre, ...items, ...post];
  full.forEach(v=>{
    const d=document.createElement('div');
    d.className='item';
    d.innerHTML=`<span>${money(v)}</span>`;
    reel.appendChild(d);
  });
  // posici√≥n inicial centrada sobre el primer premio original (despu√©s del pre)
  const startIndex = 3; // donde arranca la ‚Äúventana‚Äù
  reel.style.transform = `translateY(${-startIndex*itemH}px)`;
  reel.dataset.offset = String(startIndex*itemH);
}
buildReel();

/* Responsive: asegurar alturas correctas si cambia el zoom */
function syncItemHeight(){
  const rect = viewport.getBoundingClientRect();
  // mantenemos 120px l√≥gicos; si se quiere m√°s bajo/alto, ajustar CSS y esta constante
  itemH = 120;
}
addEventListener('resize',()=>{ syncItemHeight(); });

/* =================== Confeti (canvas simple) =================== */
const confetti = document.getElementById('confetti');
const cfx = confetti.getContext('2d');
let confettiRun=false, flakes=[];
function confettiBurst(){
  confetti.width = innerWidth; confetti.height = innerHeight;
  flakes=[]; for(let i=0;i<140;i++){
    flakes.push({x:Math.random()*innerWidth, y:-20-Math.random()*100,
      r:4+Math.random()*4, s:1+Math.random()*2, a:Math.random()*Math.PI*2,
      c: `hsl(${Math.random()*360},100%,60%)`});
  }
  confettiRun=true; requestAnimationFrame(loop);
  setTimeout(()=>{ confettiRun=false; }, 1600);
  function loop(){
    cfx.clearRect(0,0,confetti.width,confetti.height);
    flakes.forEach(f=>{
      f.y+=f.s*3; f.x+=Math.sin(f.a+=0.05)*1.5;
      cfx.beginPath(); cfx.fillStyle=f.c; cfx.arc(f.x,f.y,f.r,0,Math.PI*2); cfx.fill();
    });
    if(confettiRun) requestAnimationFrame(loop); else cfx.clearRect(0,0,confetti.width,confetti.height);
  }
}

/* =================== Modal premio =================== */
const backdrop = document.getElementById('backdrop');
const winTag = document.getElementById('winTag');
const winText = document.getElementById('winText');
const modalClaim = document.getElementById('modalClaim');
const modalClose = document.getElementById('modalClose');
function openModal(value){
  winTag.textContent = money(value);
  winText.innerHTML = `Recib√≠s <b>${money(value)} extra</b> con tu pr√≥xima carga.`;
  modalClaim.onclick = ()=> location.href = `https://wa.me/${WP}?text=${encodeURIComponent(whatsappText(value))}`;
  backdrop.classList.add('show');
  confettiBurst();
}
modalClose.onclick = ()=> backdrop.classList.remove('show');
backdrop.addEventListener('click',e=>{ if(e.target===backdrop) backdrop.classList.remove('show'); });

/* =================== Estado / contador =================== */
const badge=document.getElementById('badge');
const title=document.getElementById('title');
const subtitle=document.getElementById('subtitle');
const claimBtn=document.getElementById('claimBtn');
const spinBtn=document.getElementById('spinBtn');
const countdownEl=document.getElementById('countdown');
const promoBox=document.getElementById('promoBox');

function todayKey(){ const n=new Date(); return `${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`; }
function restoreDaily(){
  const today = todayKey();
  const storedDay = localStorage.getItem('rsp_date');
  if(storedDay && storedDay !== today){
    localStorage.removeItem('rsp_done');
    localStorage.removeItem('rsp_value');
    localStorage.setItem('rsp_date', today);
  } else if(!storedDay){
    localStorage.setItem('rsp_date', today);
  }
}
function restorePrizeIfAny(){
  const done = localStorage.getItem('rsp_done')==='1';
  const saved = localStorage.getItem('rsp_value');
  if(done && saved){
    const v = parseInt(saved,10);
    badge.textContent = money(v);
    title.textContent = "üéâ ¬°Premio obtenido!";
    subtitle.innerHTML = `Recib√≠s <b>${money(v)}</b> con tu pr√≥xima carga.`;
    claimBtn.disabled = false;
    claimBtn.onclick = ()=> location.href = `https://wa.me/${WP}?text=${encodeURIComponent(whatsappText(v))}`;
    spinBtn.disabled = true;
  }
}
function scheduleMidnightReset(){
  const now=new Date();
  const midnight=new Date(now.getFullYear(),now.getMonth(),now.getDate()+1,0,0,5,0);
  setTimeout(()=>{
    localStorage.removeItem('rsp_done');
    localStorage.removeItem('rsp_value');
    localStorage.setItem('rsp_date', todayKey());
    spinBtn.disabled=false;
    badge.textContent='-';
    title.textContent='Ten√©s 1 intento disponible';
    subtitle.innerHTML='Los premios se acreditan con tu <b>pr√≥xima carga m√≠nima</b>.';
  }, midnight.getTime()-now.getTime());
}
function endOfDay(){
  const n=new Date();
  const end=new Date(n.getFullYear(), n.getMonth(), n.getDate(), 23, 59, 0, 0).getTime();
  return end > Date.now() ? end : new Date(n.getFullYear(), n.getMonth(), n.getDate()+1, 23, 59, 0, 0).getTime();
}
function tickCountdown(){
  const ms = endOfDay() - Date.now();
  const total = Math.max(0, Math.floor(ms/1000));
  const h = Math.floor(total/3600), m = Math.floor((total%3600)/60), s = total%60;
  countdownEl.textContent = h>0 ? `${h}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`
                                : `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  if(ms<=0){
    promoBox.classList.add('expired');
    spinBtn.disabled = true;
    title.textContent = "‚è±Ô∏è Oferta finalizada";
    subtitle.innerHTML = "Los intentos se habilitan en la pr√≥xima ventana.";
    return true;
  }
  return false;
}

/* =================== Giro =================== */
function spin(){
  if(spinning) return;
  if(localStorage.getItem('rsp_done')==='1'){ alert("Ya usaste tu intento de hoy"); return; }

  spinning=true; spinBtn.disabled=true;
  if(soundOn){ if(stopTicks) stopTicks(); stopTicks = AudioKit.spinTicks(); }

  // Randomizar premio objetivo
  const idx = Math.floor(Math.random()*PRIZES.length);
  const targetValue = PRIZES[idx];

  // Posici√≥n actual:
  const cur = parseFloat(reel.dataset.offset || "360");
  // Queremos caer en el elemento "idx" dentro del tramo central (despu√©s de los 3 pre)
  const baseIndex = 3 + idx; // √≠ndice visual dentro de la lista full
  // Sumamos vueltas completas para animaci√≥n
  const rounds = 5; // vueltas
  const targetOffset = (baseIndex + rounds*PRIZES.length)*itemH;

  const start = performance.now(); const dur = 3000;
  (function loop(t){
    const k=Math.min(1,(t-start)/dur);
    const ease = 1 - Math.pow(1-k,3);
    const pos = cur + (targetOffset-cur)*ease;
    reel.style.transform = `translateY(${-pos}px)`;
    reel.dataset.offset = String(pos);
    if(k<1){ requestAnimationFrame(loop); }
    else{
      // Ajuste fino para caer exacto
      const snap = Math.round(targetOffset/itemH)*itemH;
      reel.style.transform = `translateY(${-snap}px)`; reel.dataset.offset = String(snap);

      // Premio
      badge.textContent = money(targetValue);
      title.textContent = "üéâ ¬°Premio obtenido!";
      subtitle.innerHTML = `Recib√≠s <b>${money(targetValue)}</b> con tu pr√≥xima carga.`;
      claimBtn.disabled = false;
      claimBtn.onclick = ()=> location.href = `https://wa.me/${WP}?text=${encodeURIComponent(whatsappText(targetValue))}`;

      // Persistencia
      localStorage.setItem('rsp_done','1');
      localStorage.setItem('rsp_value', String(targetValue));
      localStorage.setItem('rsp_date', todayKey());

      if(soundOn && stopTicks){ stopTicks(); AudioKit.win(); }
      openModal(targetValue);
      spinning=false;
    }
  })(start);
}

spinBtn.addEventListener('click', spin);
document.getElementById('claimBtn').addEventListener('click', ()=>{
  const v = localStorage.getItem('rsp_value');
  if(!v) return;
  location.href = `https://wa.me/${WP}?text=${encodeURIComponent(whatsappText(parseInt(v,10)))}`;
});

/* =================== Init =================== */
function init(){
  syncItemHeight();
  buildReel();
  restoreDaily();
  restorePrizeIfAny();
  tickCountdown();
  const iv=setInterval(()=>{ if(tickCountdown()) clearInterval(iv); },1000);
  scheduleMidnightReset();
}
init();
</script>
</body>
</html>
